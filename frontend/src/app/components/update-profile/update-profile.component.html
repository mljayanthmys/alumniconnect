<div class="update-profile-page">
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        
        <!-- Loading State -->
        <div *ngIf="loading && !alumni" class="text-center py-5">
          <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;"></div>
          <p class="mt-3">Loading profile...</p>
        </div>

        <!-- Profile Form -->
        <div *ngIf="alumni" class="profile-container">
          
          <!-- Header -->
          <div class="profile-header text-center mb-4">
            <div class="profile-avatar-large">
              {{ getInitials(alumni.name) }}
            </div>
            <h2 class="mt-3">{{ alumni.name }}</h2>
            <p class="text-muted">{{ alumni.jobRole }} at {{ alumni.currentCompany }}</p>
            <span *ngIf="alumni.isVerified" class="badge bg-success">
              <i class="bi bi-check-circle"></i> Verified Alumni
            </span>
          </div>

          <!-- Update Form -->
          <form (ngSubmit)="onUpdate()" #updateForm="ngForm">
            
            <!-- Personal Information -->
            <div class="form-section">
              <h4 class="section-title">
                <i class="bi bi-person-fill"></i> Personal Information
              </h4>
              
              <div class="row g-3">
                <div class="col-md-6">
                  <label class="form-label">Full Name *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    [(ngModel)]="alumni.name" 
                    name="name" 
                    required>
                </div>

                <div class="col-md-6">
                  <label class="form-label">Email Address *</label>
                  <input 
                    type="email" 
                    class="form-control" 
                    [(ngModel)]="alumni.email" 
                    name="email" 
                    required
                    disabled>
                  <small class="text-muted">Email cannot be changed</small>
                </div>

                <div class="col-md-6">
                  <label class="form-label">Phone Number</label>
                  <input 
                    type="tel" 
                    class="form-control" 
                    [(ngModel)]="alumni.phone" 
                    name="phone">
                </div>

                <div class="col-md-6">
                  <label class="form-label">Batch Year *</label>
                  <select 
                    class="form-select" 
                    [(ngModel)]="alumni.batch" 
                    name="batch" 
                    required>
                    <option value="2024">2024</option>
                    <option value="2023">2023</option>
                    <option value="2022">2022</option>
                    <option value="2021">2021</option>
                    <option value="2020">2020</option>
                    <option value="2019">2019</option>
                    <option value="2018">2018</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Professional Information -->
            <div class="form-section">
              <h4 class="section-title">
                <i class="bi bi-briefcase-fill"></i> Professional Information
              </h4>
              
              <div class="row g-3">
                <div class="col-md-6">
                  <label class="form-label">Current Company *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    [(ngModel)]="alumni.currentCompany" 
                    name="currentCompany" 
                    required>
                </div>

                <div class="col-md-6">
                  <label class="form-label">Job Role *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    [(ngModel)]="alumni.jobRole" 
                    name="jobRole" 
                    required>
                </div>

                <div class="col-md-6">
                  <label class="form-label">Location *</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    [(ngModel)]="alumni.location" 
                    name="location" 
                    required>
                </div>

                <div class="col-md-6">
                  <label class="form-label">LinkedIn Profile</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    [(ngModel)]="alumni.linkedIn" 
                    name="linkedIn">
                </div>
              </div>
            </div>

            <!-- Additional Information -->
            <div class="form-section">
              <h4 class="section-title">
                <i class="bi bi-info-circle-fill"></i> Additional Information
              </h4>
              
              <div class="row g-3">
                <div class="col-12">
                  <label class="form-label">Skills (comma-separated)</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    [(ngModel)]="skillsInput" 
                    name="skills"
                    placeholder="JavaScript, React, Node.js">
                </div>

                <div class="col-12">
                  <label class="form-label">Bio</label>
                  <textarea 
                    class="form-control" 
                    rows="4" 
                    [(ngModel)]="alumni.bio" 
                    name="bio"
                    maxlength="500"></textarea>
                  <small class="text-muted">{{ alumni.bio?.length || 0 }}/500 characters</small>
                </div>
              </div>
            </div>

            <!-- Messages -->
            <div *ngIf="successMessage" class="alert alert-success">
              <i class="bi bi-check-circle-fill"></i> {{ successMessage }}
            </div>

            <div *ngIf="errorMessage" class="alert alert-danger">
              <i class="bi bi-exclamation-triangle-fill"></i> {{ errorMessage }}
            </div>

            <!-- Action Buttons -->
            <div class="d-grid gap-2">
              <button 
                type="submit" 
                class="btn btn-primary btn-lg" 
                [disabled]="loading || !updateForm.valid">
                <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
                <span *ngIf="!loading"><i class="bi bi-save"></i> Update Profile</span>
                <span *ngIf="loading">Updating...</span>
              </button>
              
              <button 
                type="button" 
                class="btn btn-outline-secondary" 
                routerLink="/directory"
                [disabled]="loading">
                <i class="bi bi-arrow-left"></i> Back to Directory
              </button>
            </div>

          </form>

          <!-- Profile Info -->
          <div class="profile-info mt-4">
            <small class="text-muted">
              <i class="bi bi-calendar"></i> Profile created: {{ alumni.createdAt | date:'medium' }}
            </small>
            <br>
            <small class="text-muted">
              <i class="bi bi-clock"></i> Last updated: {{ alumni.updatedAt | date:'medium' }}
            </small>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>